install.packages("ape")
install.packages("phangorn")
install.packages("picante")
require(ape)
require(phangorn)
install.packages("phangorn")
source("http://bioconductor.org/bioLite.R")
install.packages("ape")
install.packages("phangorn")
require(ape)
require(phangorn)
x<-read.dna("mustelid_coI.fasta",format="fasta")
d<-dist.dna(x)
write.table(as.matrix(d),"distances.csv")
d
d2<-dist.dna(x, model="GTR")
tr.upgma<-upgma(d)
plot(tr.upgma)
tr.upgmar<-root(tr.upgma, outgroup="Melursus/1-601 urinus")
plot(tr.upgmar);nodelabels();add.scale.bar(length=0.001)
plot(tr.upgma,"f")
tr.nj<-nj(d)
plot(tr.nj)
plot(tr.nj,"p")
plot(tr.nj,"f")
plot(tr.nj,"p")
par(mfrow=c(1,2))
plot(tr.upgma,"f")
plot(tr.nj,"p")
par(mfrow=c(1,1))
dt.upgma<-cophentic(tr.upgma)
dt.upgma<-cophenetic(tr.upgma)
dmat<-as.matrix(d)
nms<-rownames(dmat)
dt.upgma<-dt.upgma[nms, nms]
d
dt.upgma<-as.dist(dt.upgma)
plot(dt.upgma-d,ylab="residuals", cex=0.5,main="UPGMA")
abline(h=0,lty=3)
tr.fast<-fastme.bal(d,nni=T,spr=T,tbr=T)
plot(tr.fast)
par(mfrow=c(2,2))
plot(tr.nj)
plot(tr.bionj)
plot.phylo(tr.bionj)
fit<-pml(tr.upgma,as.phyDat(x))
fit=optim.pml(fit,T)
plot(fit)
par(mfrow=c(1,1))
plot(fit)
set.seed(8)
bs<-bootstrap.pml(fit,bs=100,optNni=T)
treeBS<-plotBS(fit$tree, type="fan", bs)
treeBS<-plotBS(fit$tree, type="p", bs)
mt<-modelTest(as.phyDat(x),G=F,I=F)
dhky<-dist.dna(x,model="GTR")
orig<-evol.distinct(tr.upgma,type="fair.proportion")
orig
orig<-evol.distinct(tr.upgma,type="fair.proportion")orig
plot(tr.fast)
par(mfrow=c(2,2))
par(mar=rep(1,4))
plot(tr.upgma,"f")
plot(dt.upgma-d,ylab="residuals", cex=0.5,main="UPGMA")
plot(tr.fast)
plot.phylo(tr.bionj)
plot(tr.bionj)
plot(tr.nj)
plot(fit)
treeBS<-plotBS(fit$tree, type="fan", bs)
treeBS<-plotBS(fit$tree, type="p", bs)
View(mt)
View(dmat)
par(mfrow=c(1,1))
par(mar=rep(1,1))
plot(dt.upgma-d,ylab="residuals", cex=0.5,main="UPGMA")
source("http://bioconductor.org/biocLite.R")
biocLite(c("affy", "limma"))
library(GEOquery)
library(affy) #Affymetrix pre-processing
library(hgu133plus2.db)
library(annotate)
library(limma) #Two-colour pre-processing; differential expression
workingDir="GCOS_Cel"
filenames <- c("ROS1-_9.CEL", "ROS1+_10.CEL", "ROS2-_11.CEL", "ROS2+_12.CEL", "ROS3-_13.CEL", "ROS3+_14", "ROS4-_15", "ROS4+_16")
samplenames <- c("ROS1-_9.CEL", "ROS1+_10.CEL", "ROS2-_11.CEL", "ROS2+_12.CEL", "ROS3-_13.CEL", "ROS3+_14", "ROS4-_15", "ROS4+_16")
targets <- c("minus", "plus", "minus", "plus", "minus", "plus", "minus", "plus")
phenodata<-as.data.frame(cbind(filenames,samplenames,targets))
celdata <- ReadAffy(celfile.path="home/rnmaconeghy/BS32010/Project/GCOS_Cel", compress=T, phenoData=phenodata)
dir.create(workingDir)
cels <- list.files(workingDir, pattern = "[gz")
cels <- list.files(workingDir, pattern = "[gz]")
sapply(paste(workingDir, cels, sep="/"), gunzip)
setwd("~/BS32010/Project/GCOS_Cel")
sapply(paste(workingDir, cels, sep="/"), gunzip)
workingDir="GCOS_Cel_test"
dir.create(workingDir)
cels <- list.files(workingDir, pattern = "[gz]")
sapply(paste(workingDir, cels, sep="/"), gunzip)
workingDir="GCOS_Cel"
dir.create(workingDir)
cels <- list.files(workingDir, pattern = "[gz]")
sapply(paste(workingDir, cels, sep="/"), gunzip)
require(DESeq2)
require(RCurl)
remoteFile <- getURL(paste0("http://www.compbio.dundee.ac.uk/", "user/pschofield/Teaching/Bioinformatics/", "Data/RNAseqCounts.txt"))
dat<-read.delim("/usr/local/share/BS32010/expression/data/RNAseqCounts.txt", sep="\t",skip=1,head=T)
geneCounts<-read.delim(textConnection(remoteFile), head=T, sep="\t",skip=1)
nonZeroCounts<-geneCounts[rowSums(geneCounts[,7:12])>0,7:12]
treatments <- as.factor(substr(colnames(nonZeroCounts),1,1))
dds<- DESeqDataSetFromMatrix(as.matrix(nonZeroCounts), as.data.frame(treatments), design= ~ treatments)
View(dat)
View(geneCounts)
View(nonZeroCounts)
View(phenodata)
dds$treatments <- relevel(dds$treaments, "U")
dds <-DESeq(dds)
require(biomaRt)
DEresults <- results(dds)
mart <- useMart (biomart="ENSEMBLE_MART_ENSEMBLE", host="www.ensemble.org", path="/biomart/martservice")
mart <- useMart (biomart="ENSEMBL_MART_ENSEMBL", host="www.ensembl.org", path="/biomart/martservice")
gg4 <- useDataset("ggallus_gene_ensembl", mart=mart)
annot <- getBM(attributes=c("ensembl_gene_id", "exteral_gene_id", "affy_chicken"), filter="ensembl_gene_id", values=rownames(DEresults), mart=gg4)
annot <- getBM(attributes=c("ensembl_gene_id", "external_gene_id", "affy_chicken"), filter="ensembl_gene_id", values=rownames(DEresults), mart=gg4)
annotResults <- merge(annot,DEresults, by.x="ensembl_gene_id",by.y="row.names")
View(annot)
res <- results(dds)
head(res)
mcols(res)
sum( res$pvalue < 0.05, na.rm=TRUE)
table( is.na(res$pvalue) )
sum( res$padj < 0.1, na.rm=TRUE )
resSig <- res[ which(res$padj <0.1 ), ]
head( resSig[ order( resSig$log2FoldChange ), ] )
tail( resSig[ order( resSig$log2FoldChange ), ] )
plot(attr(res,"filterNumRej"),type="b", ylab="number of rejections")
sum(res$padj < 0.1, na.rm=TRUE)
resNoFilt <- results(dds, independentFiltering=FALSE)
sum(resNoFilt$padj < 0.1, na.rm=TRUE)
plotMA(dds, ylim = c(-1.5,1.5))
hist(res$pvalue, breaks=100)
sampleDists <- dist(t(assay(rld)))
plotMA(dds, ylim = c(-2,2), main="DESeq2")
colData(dds)
rld <- rlogTransformation(dds, blind=TRUE)
vsd <- varianceStabilizingTransformation(dds, blind=TRUE)
workingDir="/homes/rnmaconeghy/BS32010/Project/GCOS_Cel"
filenames <- c("ROS1-_9.CEL", "ROS1+_10.CEL", "ROS2-_11.CEL", "ROS2+_12.CEL", "ROS3-_13.CEL", "ROS3+_14", "ROS4-_15", "ROS4+_16")
samplenames <- c("ROS1-_9.CEL", "ROS1+_10.CEL", "ROS2-_11.CEL", "ROS2+_12.CEL", "ROS3-_13.CEL", "ROS3+_14", "ROS4-_15", "ROS4+_16")
targets <- c("minus", "plus", "minus", "plus", "minus", "plus", "minus", "plus")
phenodata<-as.data.frame(cbind(filenames,samplenames,targets))
celRAW <- ReadAffy(celfile.path=workingDir, phenoData=phenodata)
celfiles <- system.file("extdata", package = "arrays")
eset <- justRMA(phenoData = phenoData, celfile.path = celfiles)
View(mapCdfName)
source('~/BS32010/Project/NormalisationsCode.R')
